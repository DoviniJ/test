<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Remove related samples while keeping maximum number of samples in cohort. — relatednessFilter • plinkQC</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Remove related samples while keeping maximum number of samples in cohort. — relatednessFilter" />

<meta property="og:description" content="filterRelatedness takes a data.frame with pair-wise relatedness measures
of samples and returns, returns samples" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plinkQC</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file"></span>
     
    documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plinkQC.html">Step-by-step QC</a>
    </li>
    <li>
      <a href="../articles/AncestryCheck.html">Ancestry</a>
    </li>
    <li>
      <a href="../articles/HapMap.html">HapMap III reference</a>
    </li>
    <li>
      <a href="../articles/1000Genomes.html">1000 Genomes reference</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/HannahVMeyer/plinkQC">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove related samples while keeping maximum number of samples in cohort.</h1>
    <small class="dont-index">Source: <a href='https://github.com/HannahVMeyer/plinkQC/blob/master/R/utils.R'><code>R/utils.R</code></a></small>
    <div class="hidden name"><code>relatednessFilter.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>filterRelatedness takes a data.frame with pair-wise relatedness measures
of samples and returns, returns samples</p>
    
    </div>

    <pre class="usage"><span class='fu'>relatednessFilter</span>(<span class='no'>relatedness</span>, <span class='kw'>otherCriterion</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>relatednessTh</span>,
  <span class='kw'>otherCriterionTh</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>otherCriterionThDirection</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"gt"</span>, <span class='st'>"ge"</span>,
  <span class='st'>"lt"</span>, <span class='st'>"le"</span>, <span class='st'>"eq"</span>), <span class='kw'>relatednessIID1</span> <span class='kw'>=</span> <span class='st'>"IID1"</span>,
  <span class='kw'>relatednessIID2</span> <span class='kw'>=</span> <span class='st'>"IID2"</span>, <span class='kw'>relatednessFID1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>relatednessFID2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>relatednessRelatedness</span> <span class='kw'>=</span> <span class='st'>"PI_HAT"</span>,
  <span class='kw'>otherCriterionIID</span> <span class='kw'>=</span> <span class='st'>"IID"</span>, <span class='kw'>otherCriterionMeasure</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>relatedness</th>
      <td><p>[data.frame] containing pair-wise relatedness estimates
(in column [relatednessRelatedness]) for individual 1 (in column
[relatednessIID1] and individual 2 (in column [relatednessIID1]). Columns
relatednessIID1, relatednessIID2 and relatednessRelatedness have to present,
while additional columns such as family IDs can be present. Default column
names correspond to column names in output of plink --genome
(<a href='https://www.cog-genomics.org/plink/1.9/ibd'>https://www.cog-genomics.org/plink/1.9/ibd</a>). All original
columns for pair-wise highIBDTh fails will be returned in fail_IBD.</p></td>
    </tr>
    <tr>
      <th>otherCriterion</th>
      <td><p>[data.frame] containing a QC measure (in column
[otherCriterionMeasure]) per individual (in column [otherCriterionIID]).
otherCriterionMeasure and otherCriterionIID have to present, while additional
columns such as family IDs can be present. IIDs in relatednessIID1 have to
be present in otherCriterionIID.</p></td>
    </tr>
    <tr>
      <th>relatednessTh</th>
      <td><p>[double] Threshold for filtering related individuals.
Individuals, whose pair-wise relatedness estimates that are greater than this
threshold are considered related.</p></td>
    </tr>
    <tr>
      <th>otherCriterionTh</th>
      <td><p>[double] Threshold for filtering individuals based on
otherCriterionMeasure. If related individuals fail this threshold they will
automatically be excluded.</p></td>
    </tr>
    <tr>
      <th>otherCriterionThDirection</th>
      <td><p>[character] Used to determine the direction
for failing the otherCriterionTh. If 'gt', indiviuals whose
otherCriterionMeasure &gt; otherCriterionTh will automatically be excluded.
For pairs of individuals that have no other related samples in the cohort:
if both otherCriterionMeasure &lt; otherCriterionTh, the individual with the
larger otherCriterionMeasure will be excluded.</p></td>
    </tr>
    <tr>
      <th>relatednessIID1</th>
      <td><p>[character] Column name of column containing the IDs
of the first individual.</p></td>
    </tr>
    <tr>
      <th>relatednessIID2</th>
      <td><p>[character] Column name of column containing the IDs
of the second individual.</p></td>
    </tr>
    <tr>
      <th>relatednessFID1</th>
      <td><p>[character, optional] Column name of column containing
the family IDs of the first individual; if only relatednessFID1 but not
relatednessFID2 provided, or none provided even though present in
relatedness, FIDs will not be returned.</p></td>
    </tr>
    <tr>
      <th>relatednessFID2</th>
      <td><p>[character, optional] Column name of column containing
the family IDs of the second individual; if only relatednessFID2 but not
relatednessFID1 provided, or none provided even though present in
relatedness, FIDs will not be returned.</p></td>
    </tr>
    <tr>
      <th>relatednessRelatedness</th>
      <td><p>[character] Column name of column containing
the relatedness estimate.</p></td>
    </tr>
    <tr>
      <th>otherCriterionIID</th>
      <td><p>[character] Column name of column containing the
individual IDs.</p></td>
    </tr>
    <tr>
      <th>otherCriterionMeasure</th>
      <td><p>[character] Column name of the column containing
the measure of the otherCriterion (for instance SNP missingness rate).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>named [list] with i) relatednessFails, a [data.frame] containing the
reordered input data.frame relatedness after filtering for pairs of
individuals in relatednessIID1 and relatednessIID2, that fail the relatedness
QC and ii) failIDs, a [data.frame] with the [IID]s (and [FID]s if provided)
of the individuals that fail the relatednessTh.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>filterRelatedness finds pairs of samples whose relatedness estimate is larger
than the specified relatednessTh. Subsequently, for pairs of individual that
do not have additional relatives in the dataset, the individual with the
worse otherCriterionMeasure (if provided) or arbitrarily individual 1 of that
pair is selected and returned as the individual failing
the relatedness check. For more complex family structures, the unrelated
individuals per family are selected (e.g. in a parents-offspring trio, the
offspring will be marked as fail, while the parents will be kept in the
analysis).</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

