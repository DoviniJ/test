<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identification of individuals of divergent ancestry — check_ancestry • plinkQC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Identification of individuals of divergent ancestry — check_ancestry" />
<meta property="og:description" content="Runs and evaluates results of plink --pca on merged genotypes from
individuals to be QCed and individuals of reference population of known
genotypes. Currently, check ancestry only supports automatic selection of
individuals of European descent. It uses information from principal
components 1 and 2 returned by plink --pca to find the center of the European
reference samples (mean(PC1_europeanRef), mean(PC2_europeanRef). It then
computes the maximum Euclidean distance (maxDist) of the European reference
samples from this centre. All study samples whose Euclidean distance from the
centre falls outside the circle described by the radius r=europeanTh* maxDist
are considered non-European and their IDs are returned as failing the
ancestry check.
check_ancestry creates a scatter plot of PC1 versus PC2 colour-coded
for samples of the reference populations and the study population." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plinkQC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plinkQC.html">Step-by-step QC</a>
    </li>
    <li>
      <a href="../articles/AncestryCheck.html">Ancestry</a>
    </li>
    <li>
      <a href="../articles/HapMap.html">HapMap III reference</a>
    </li>
    <li>
      <a href="../articles/Genomes1000.html">1000 Genomes reference</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-code"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/HannahVMeyer/plinkQC">
    <span class="fas fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identification of individuals of divergent ancestry</h1>
    <small class="dont-index">Source: <a href='https://github.com/meyer-lab-cshl/plinkQC/blob/master/R/individualQC.R'><code>R/individualQC.R</code></a></small>
    <div class="hidden name"><code>check_ancestry.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Runs and evaluates results of plink --pca on merged genotypes from
individuals to be QCed and individuals of reference population of known
genotypes. Currently, check ancestry only supports automatic selection of
individuals of European descent. It uses information from principal
components 1 and 2 returned by plink --pca to find the center of the European
reference samples (mean(PC1_europeanRef), mean(PC2_europeanRef). It then
computes the maximum Euclidean distance (maxDist) of the European reference
samples from this centre. All study samples whose Euclidean distance from the
centre falls outside the circle described by the radius r=europeanTh* maxDist
are considered non-European and their IDs are returned as failing the
ancestry check.
<code>check_ancestry</code> creates a scatter plot of PC1 versus PC2 colour-coded
for samples of the reference populations and the study population.</p>
    </div>

    <pre class="usage"><span class='fu'>check_ancestry</span><span class='op'>(</span>
  <span class='va'>indir</span>,
  <span class='va'>name</span>,
  qcdir <span class='op'>=</span> <span class='va'>indir</span>,
  <span class='va'>prefixMergedDataset</span>,
  europeanTh <span class='op'>=</span> <span class='fl'>1.5</span>,
  refPopulation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CEU"</span>, <span class='st'>"TSI"</span><span class='op'>)</span>,
  refSamples <span class='op'>=</span> <span class='cn'>NULL</span>,
  refColors <span class='op'>=</span> <span class='cn'>NULL</span>,
  refSamplesFile <span class='op'>=</span> <span class='cn'>NULL</span>,
  refColorsFile <span class='op'>=</span> <span class='cn'>NULL</span>,
  refSamplesIID <span class='op'>=</span> <span class='st'>"IID"</span>,
  refSamplesPop <span class='op'>=</span> <span class='st'>"Pop"</span>,
  refColorsColor <span class='op'>=</span> <span class='st'>"Color"</span>,
  refColorsPop <span class='op'>=</span> <span class='st'>"Pop"</span>,
  studyColor <span class='op'>=</span> <span class='st'>"#2c7bb6"</span>,
  legend_labels_per_row <span class='op'>=</span> <span class='fl'>6</span>,
  run.check_ancestry <span class='op'>=</span> <span class='cn'>TRUE</span>,
  interactive <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='va'>verbose</span>,
  path2plink <span class='op'>=</span> <span class='cn'>NULL</span>,
  showPlinkOutput <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>indir</th>
      <td><p>[character] /path/to/directory containing the basic PLINK data
files name.bim, name.bed, name.fam files.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>[character] prefix of plink files, i.e. name.bed, name.bim,
name.fam.</p></td>
    </tr>
    <tr>
      <th>qcdir</th>
      <td><p>[character] /path/to/directory where
prefixMergedDataset.eigenvec results as returned by plink --pca should be
saved. Per default qcdir=indir. If run.check_ancestry is FALSE, it is assumed
that plink --pca prefixMergedDataset has been run and
qcdir/prefixMergedDataset.eigenvec exists.User needs writing permission to
qcdir.</p></td>
    </tr>
    <tr>
      <th>prefixMergedDataset</th>
      <td><p>[character] Prefix of merged dataset (study and
reference samples) used in plink --pca, resulting in
prefixMergedDataset.eigenvec.</p></td>
    </tr>
    <tr>
      <th>europeanTh</th>
      <td><p>[double] Scaling factor of radius to be drawn around center
of European reference samples, with study samples inside this radius
considered to be of European descent and samples outside this radius of
non-European descent. The radius is computed as the maximum Euclidean
distance of European reference samples to the centre of European reference
samples.</p></td>
    </tr>
    <tr>
      <th>refPopulation</th>
      <td><p>[vector] Vector with population identifiers of European
reference population. Identifiers have to be corresponding to population IDs
[refColorsPop] in refColorsfile/refColors.</p></td>
    </tr>
    <tr>
      <th>refSamples</th>
      <td><p>[data.frame] Dataframe with sample identifiers
[refSamplesIID] corresponding to IIDs in prefixMergedDataset.eigenvec and
population identifier [refSamplesPop] corresponding to population IDs
[refColorsPop] in refColorsfile/refColors. Either refSamples or
refSamplesFile have to be specified.</p></td>
    </tr>
    <tr>
      <th>refColors</th>
      <td><p>[data.frame, optional] Dataframe with population IDs in
column [refColorsPop] and corresponding colour-code for PCA plot in column
[refColorsColor]. If not provided and is.null(refColorsFile) default colors
are used.</p></td>
    </tr>
    <tr>
      <th>refSamplesFile</th>
      <td><p>[character] /path/to/File/with/reference samples. Needs
columns with sample identifiers [refSamplesIID] corresponding to IIDs in
prefixMergedDataset.eigenvec and population identifier [refSamplesPop]
corresponding to population IDs [refColorsPop] in refColorsfile/refColors.</p></td>
    </tr>
    <tr>
      <th>refColorsFile</th>
      <td><p>[character, optional]
/path/to/File/with/Population/Colors containing population IDs in column
[refColorsPop] and corresponding colour-code for PCA plot in column
[refColorsColor].If not provided and is.null(refColors) default colors for
are used.</p></td>
    </tr>
    <tr>
      <th>refSamplesIID</th>
      <td><p>[character] Column name of reference sample IDs in
refSamples/refSamplesFile.</p></td>
    </tr>
    <tr>
      <th>refSamplesPop</th>
      <td><p>[character] Column name of reference sample population
IDs in refSamples/refSamplesFile.</p></td>
    </tr>
    <tr>
      <th>refColorsColor</th>
      <td><p>[character] Column name of population colors in
refColors/refColorsFile</p></td>
    </tr>
    <tr>
      <th>refColorsPop</th>
      <td><p>[character] Column name of reference sample population
IDs in refColors/refColorsFile.</p></td>
    </tr>
    <tr>
      <th>studyColor</th>
      <td><p>[character] Colour to be used for study population.</p></td>
    </tr>
    <tr>
      <th>legend_labels_per_row</th>
      <td><p>[integer] Number of population names per row in PCA plot.</p></td>
    </tr>
    <tr>
      <th>run.check_ancestry</th>
      <td><p>[logical] Should plink --pca be run to
determine principal components of merged dataset; if FALSE, it is assumed
that plink --pca has been run successfully and
qcdir/prefixMergedDataset.eigenvec is present;
<code>check_ancestry</code> will fail with missing file error otherwise.</p></td>
    </tr>
    <tr>
      <th>interactive</th>
      <td><p>[logical] Should plots be shown interactively? When
choosing this option, make sure you have X-forwarding/graphical interface
available for interactive plotting. Alternatively, set interactive=FALSE and
save the returned plot object (p_ancestry) via ggplot2::ggsave(p=p_ancestry,
other_arguments) or pdf(outfile) print(p_ancestry) dev.off().</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>[logical] If TRUE, progress info is printed to standard out.</p></td>
    </tr>
    <tr>
      <th>path2plink</th>
      <td><p>[character] Absolute path to PLINK executable
(<a href='https://www.cog-genomics.org/plink/1.9/'>https://www.cog-genomics.org/plink/1.9/</a>) i.e.
plink should be accesible as path2plink -h. The full name of the executable
should be specified: for windows OS, this means path/plink.exe, for unix
platforms this is path/plink. If not provided, assumed that PATH set-up works
and PLINK will be found by <code><a href='https://rdrr.io/pkg/sys/man/exec.html'>exec</a></code>('plink').</p></td>
    </tr>
    <tr>
      <th>showPlinkOutput</th>
      <td><p>[logical] If TRUE, plink log and error messages are
printed to standard out.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Named [list] with i) fail_ancestry, containing a [data.frame] with
FID and IID of non-European individuals and ii) p_ancestry, a ggplot2-object
'containing' a scatter plot of PC1 versus PC2 colour-coded for samples of the
reference populations and the study population, which can be shown by
print(p_ancestry).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>indir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, package<span class='op'>=</span><span class='st'>"plinkQC"</span><span class='op'>)</span>
<span class='va'>name</span> <span class='op'>&lt;-</span> <span class='st'>"data"</span>
<span class='va'>fail_ancestry</span> <span class='op'>&lt;-</span> <span class='fu'>check_ancestry</span><span class='op'>(</span>indir<span class='op'>=</span><span class='va'>indir</span>, name<span class='op'>=</span><span class='va'>name</span>,
refSamplesFile<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>indir</span>, <span class='st'>"/HapMap_ID2Pop.txt"</span>,sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>,
refColorsFile<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>indir</span>, <span class='st'>"/HapMap_PopColors.txt"</span>, sep<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>,
prefixMergedDataset<span class='op'>=</span><span class='st'>"data.HapMapIII"</span>, interactive<span class='op'>=</span><span class='cn'>FALSE</span>,
run.check_ancestry<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


